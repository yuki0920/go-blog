
## Protocol Buffers

### 概要
- シリアライゼーション・フォーマットであり、そのデータは任意の方法で送ることができる

### gRPC or Pub/Sub
- gRPC で同期的にやりとりを行うか、メッセージング・サービスである Google Cloud Pub/Sub で非同期的にやりとりを行うかの二つの手段が考えられる
- マイクロサービス・アーキテクチャのような分散システムにおいては、全てを同期的にやりとりしてしまうと強い依存関係が生じてしまうため、非同期メッセージングが適した箇所では Pub/Sub を利用するケースが多い

### 記法
```proto
service AddressBookService {
  rpc Search (SearchRequest) returns(SearchResponse);
}
```

今回は、SearchRequestを引数として受け取ってSearchResponseを返す、SearchというRPCメソッドをもった、AddressBookServiceというサービスを定義しました。

## gRPC

### 概要
- アプリケーション通信の技術
- RESTとの比較での最大のメリットは、Protocol Buffersにフォーマットするためスキーマファースト、スキーマ駆動で開発ができ、生産性が高い

### リクエスト、レスポンスの種類
- 通常: リクエスト1つ、レスポンス1つ。同期的処理
- サーバーストリーミングRPC: リクエスト1つ、レスポンス複数。お知らせ通知やタイムラインのリアルタイム更新に有用
- クライアントストリーミングRPC: リクエスト複数、レスポンス1つ。大きなデータを分割してアップロードしたい場合に有用
- 双方向ストリーミングRPC: リクエスト後は、リクエスト、レスポンスが任意のタイミングで発行される。チャットやゲームに有用

### インタセプタ
- gRPCにおけるミドルウェア
- リクエストを受け取る前、レスポンスを返した後の処理を担う
- 用途として、認証、ログ、監視等の処理をするケースが多い


## ツール
- protc: Protocol Buffers からコードを生成する
- protoc-gen-go: protoc からコードを生成するための言語ごとにプラグイン
- grpc_cli: ローカルで動作確認する
